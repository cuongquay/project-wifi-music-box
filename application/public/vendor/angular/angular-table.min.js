/*! GO4SMAC - v0.1.1 - 2015-09-28 */!function(angular,factory){"use strict";return"function"==typeof define&&define.amd?void define(["angular"],function(angular){return factory(angular)}):factory(angular)}(angular||null,function(angular){"use strict";var app=angular.module("ngTable",[]);app.factory("ngTableParams",["$q","$log",function($q,$log){var isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},ngTableParams=function(baseParameters,baseSettings){var self=this,log=function(){settings.debugMode&&$log.debug&&$log.debug.apply(this,arguments)};this.data=[],this.parameters=function(newParameters,parseParamsFromUrl){if(parseParamsFromUrl=parseParamsFromUrl||!1,angular.isDefined(newParameters)){for(var key in newParameters){var value=newParameters[key];if(parseParamsFromUrl&&key.indexOf("[")>=0){for(var keys=key.split(/\[(.*)\]/).reverse(),lastKey="",i=0,len=keys.length;len>i;i++){var name=keys[i];if(""!==name){var v=value;value={},value[lastKey=name]=isNumber(v)?parseFloat(v):v}}"sorting"===lastKey&&(params[lastKey]={}),params[lastKey]=angular.extend(params[lastKey]||{},value[lastKey])}else params[key]=isNumber(newParameters[key])?parseFloat(newParameters[key]):newParameters[key]}return log("ngTable: set parameters",params),this}return params},this.settings=function(newSettings){return angular.isDefined(newSettings)?(angular.isArray(newSettings.data)&&(newSettings.total=newSettings.data.length),settings=angular.extend(settings,newSettings),log("ngTable: set settings",settings),this):settings},this.page=function(page){return angular.isDefined(page)?this.parameters({page:page}):params.page},this.total=function(total){return angular.isDefined(total)?this.settings({total:total}):settings.total},this.count=function(count){return angular.isDefined(count)?this.parameters({count:count,page:1}):params.count},this.filter=function(filter){return angular.isDefined(filter)?this.parameters({filter:filter}):params.filter},this.sorting=function(sorting){if(2==arguments.length){var sortArray={};return sortArray[sorting]=arguments[1],this.parameters({sorting:sortArray}),this}return angular.isDefined(sorting)?this.parameters({sorting:sorting}):params.sorting},this.isSortBy=function(field,direction){return angular.isDefined(params.sorting[field])&&params.sorting[field]==direction},this.orderBy=function(){var sorting=[];for(var column in params.sorting)sorting.push(("asc"===params.sorting[column]?"+":"-")+column);return sorting},this.getData=function($defer,params){$defer.resolve(angular.isArray(this.data)&&angular.isObject(params)?this.data.slice((params.page()-1)*params.count(),params.page()*params.count()):[])},this.getGroups=function($defer,column){var defer=$q.defer();defer.promise.then(function(data){var groups={};angular.forEach(data,function(item){var groupName=angular.isFunction(column)?column(item):item[column];groups[groupName]=groups[groupName]||{data:[]},groups[groupName].value=groupName,groups[groupName].data.push(item)});var result=[];for(var i in groups)result.push(groups[i]);log("ngTable: refresh groups",result),$defer.resolve(result)}),this.getData(defer,self)},this.generatePagesArray=function(currentPage,totalItems,pageSize){var maxBlocks,maxPage,maxPivotPages,minPage,numPages,pages;if(maxBlocks=11,pages=[],numPages=Math.ceil(totalItems/pageSize),numPages>1){pages.push({type:"prev",number:Math.max(1,currentPage-1),active:currentPage>1}),pages.push({type:"first",number:1,active:currentPage>1}),maxPivotPages=Math.round((maxBlocks-5)/2),minPage=Math.max(2,currentPage-maxPivotPages),maxPage=Math.min(numPages-1,currentPage+2*maxPivotPages-(currentPage-minPage)),minPage=Math.max(2,minPage-(2*maxPivotPages-(maxPage-minPage)));for(var i=minPage;maxPage>=i;)pages.push(i===minPage&&2!==i||i===maxPage&&i!==numPages-1?{type:"more",active:!1}:{type:"page",number:i,active:currentPage!==i}),i++;pages.push({type:"last",number:numPages,active:currentPage!==numPages}),pages.push({type:"next",number:Math.min(numPages,currentPage+1),active:numPages>currentPage})}return pages},this.url=function(asString){asString=asString||!1;var pairs=asString?[]:{};for(var key in params)if(params.hasOwnProperty(key)){var item=params[key],name=encodeURIComponent(key);if("object"==typeof item){for(var subkey in item)if(!angular.isUndefined(item[subkey])&&""!==item[subkey]){var pname=name+"["+encodeURIComponent(subkey)+"]";asString?pairs.push(pname+"="+item[subkey]):pairs[pname]=item[subkey]}}else angular.isFunction(item)||angular.isUndefined(item)||""===item||(asString?pairs.push(name+"="+encodeURIComponent(item)):pairs[name]=encodeURIComponent(item))}return pairs},this.reload=function(){var $defer=$q.defer(),self=this;settings.$loading=!0,settings.groupBy?settings.getGroups($defer,settings.groupBy,this):settings.getData($defer,this),log("ngTable: reload data"),$defer.promise.then(function(data){settings.$loading=!1,log("ngTable: current scope",settings.$scope),settings.groupBy?self.data=settings.$scope.$groups=data:self.data=settings.$scope.$data=data,settings.$scope.pages=self.generatePagesArray(self.page(),self.total(),self.count()),settings.$scope.$emit("ngTableAfterReloadData")})},this.reloadPages=function(){var self=this;settings.$scope.pages=self.generatePagesArray(self.page(),self.total(),self.count())};var params=this.$params={page:1,count:1,filter:{},sorting:{},group:{},groupBy:null},settings={$scope:null,$loading:!1,data:null,total:0,defaultSort:"desc",filterDelay:750,counts:[10,25,50,100],getGroups:this.getGroups,getData:this.getData};return this.settings(baseSettings),this.parameters(baseParameters,!0),this};return ngTableParams}]);var ngTableController=["$scope","ngTableParams","$timeout",function($scope,ngTableParams,$timeout){$scope.$loading=!1,$scope.params||($scope.params=new ngTableParams),$scope.params.settings().$scope=$scope;var delayFilter=function(){var timer=0;return function(callback,ms){$timeout.cancel(timer),timer=$timeout(callback,ms)}}();$scope.$watch("params.$params",function(newParams,oldParams){$scope.params.settings().$scope=$scope,angular.equals(newParams.filter,oldParams.filter)?$scope.params.reload():delayFilter(function(){$scope.params.$params.page=1,$scope.params.reload()},$scope.params.settings().filterDelay)},!0),$scope.sortBy=function(column,event){var parsedSortable=$scope.parse(column.sortable);if(parsedSortable){var defaultSort=$scope.params.settings().defaultSort,inverseSort="asc"===defaultSort?"desc":"asc",sorting=$scope.params.sorting()&&$scope.params.sorting()[parsedSortable]&&$scope.params.sorting()[parsedSortable]===defaultSort,sortingParams=event.ctrlKey||event.metaKey?$scope.params.sorting():{};sortingParams[parsedSortable]=sorting?inverseSort:defaultSort,$scope.params.parameters({sorting:sortingParams})}}}];return app.directive("ngTable",["$compile","$q","$parse",function($compile,$q,$parse){return{restrict:"A",priority:1001,scope:!0,controller:ngTableController,compile:function(element){var columns=[],i=0,row=null,thead=element.find("thead");return angular.forEach(angular.element(element.find("tr")),function(tr){tr=angular.element(tr),tr.hasClass("ng-table-group")||row||(row=tr)}),row?(angular.forEach(row.find("td"),function(item){var el=angular.element(item);if(!el.attr("ignore-cell")||"true"!==el.attr("ignore-cell")){var parsedAttribute=function(attr,defaultValue){return function(scope){return $parse(el.attr("x-data-"+attr)||el.attr("data-"+attr)||el.attr(attr))(scope,{$columns:columns})||defaultValue}},parsedTitle=parsedAttribute("title"," "),headerTemplateURL=parsedAttribute("header",!1),filter=parsedAttribute("filter",!1)(),filterTemplateURL=!1,filterName=!1;filter&&filter.$$name&&(filterName=filter.$$name,delete filter.$$name),filter&&filter.templateURL&&(filterTemplateURL=filter.templateURL,delete filter.templateURL),el.attr("data-title-text",parsedTitle()),columns.push({id:i++,title:parsedTitle,sortable:parsedAttribute("sortable",!1),"class":el.attr("x-data-header-class")||el.attr("data-header-class")||el.attr("header-class"),filter:filter,filterTemplateURL:filterTemplateURL,filterName:filterName,headerTemplateURL:headerTemplateURL,filterData:el.attr("filter-data")?el.attr("filter-data"):null,show:el.attr("ng-show")?function(scope){return $parse(el.attr("ng-show"))(scope)}:function(){return!0}})}}),function(scope,element,attrs){if(scope.$loading=!1,scope.$columns=columns,scope.$watch(attrs.ngTable,function(params){angular.isUndefined(params)||(scope.paramsModel=$parse(attrs.ngTable),scope.params=params)},!0),scope.parse=function(text){return angular.isDefined(text)?text(scope):""},attrs.showFilter&&scope.$parent.$watch(attrs.showFilter,function(value){scope.show_filter=value}),angular.forEach(columns,function(column){var def;if(column.filterData){if(def=$parse(column.filterData)(scope,{$column:column}),!angular.isObject(def)||!angular.isObject(def.promise))throw new Error("Function "+column.filterData+" must be instance of $q.defer()");return delete column.filterData,def.promise.then(function(data){angular.isArray(data)||(data=[]),data.unshift({title:"-",id:""}),column.data=data})}}),!element.hasClass("ng-table")){scope.templates={header:attrs.templateHeader?attrs.templateHeader:"ng-table/header.html",pagination:attrs.templatePagination?attrs.templatePagination:"ng-table/pager.html"};var headerTemplate=thead.length>0?thead:angular.element(document.createElement("thead")).attr("ng-include","templates.header"),paginationTemplate=angular.element(document.createElement("div")).attr({"ng-table-pagination":"params","template-url":"templates.pagination"});element.find("thead").remove(),element.addClass("ng-table").prepend(headerTemplate).after(paginationTemplate),$compile(headerTemplate)(scope),$compile(paginationTemplate)(scope)}}):void 0}}}]),app.directive("ngTablePagination",["$compile",function($compile){return{restrict:"A",scope:{params:"=ngTablePagination",templateUrl:"="},replace:!1,link:function(scope,element,attrs){scope.params.settings().$scope.$on("ngTableAfterReloadData",function(){scope.pages=scope.params.generatePagesArray(scope.params.page(),scope.params.total(),scope.params.count())},!0),scope.$watch("templateUrl",function(templateUrl){if(!angular.isUndefined(templateUrl)){var template=angular.element(document.createElement("div"));template.attr({"ng-include":"templateUrl"}),element.append(template),$compile(template)(scope)}})}}}]),angular.module("ngTable").run(["$templateCache",function($templateCache){$templateCache.put("ng-table/filters/select-multiple.html",'<select ng-options="data.id as data.title for data in column.data" multiple ng-multiple="true" ng-model="params.filter()[name]" ng-show="filter==\'select-multiple\'" class="filter filter-select-multiple form-control" name="{{column.filterName}}"> </select>'),$templateCache.put("ng-table/filters/select.html",'<select ng-options="data.id as data.title for data in column.data" ng-model="params.filter()[name]" ng-show="filter==\'select\'" class="filter filter-select form-control" name="{{column.filterName}}"> </select>'),$templateCache.put("ng-table/filters/text.html",'<input type="text" name="{{column.filterName}}" ng-model="params.filter()[name]" ng-if="filter==\'text\'" class="input-filter form-control"/>'),$templateCache.put("ng-table/header.html",'<tr> <th ng-repeat="column in $columns" ng-class="{ \'sortable\': parse(column.sortable), \'sort-asc\': params.sorting()[parse(column.sortable)]==\'asc\', \'sort-desc\': params.sorting()[parse(column.sortable)]==\'desc\' }" ng-click="sortBy(column, $event)" ng-show="column.show(this)" ng-init="template=column.headerTemplateURL(this)" class="header {{column.class}}"> <div ng-if="!template" ng-show="!template" ng-bind="parse(column.title)"></div> <div ng-if="template" ng-show="template"><div ng-include="template"></div></div> </th> </tr> <tr ng-show="show_filter" class="ng-table-filters"> <th ng-repeat="column in $columns" ng-show="column.show(this)" class="filter"> <div ng-repeat="(name, filter) in column.filter"> <div ng-if="column.filterTemplateURL" ng-show="column.filterTemplateURL"> <div ng-include="column.filterTemplateURL"></div> </div> <div ng-if="!column.filterTemplateURL" ng-show="!column.filterTemplateURL"> <div ng-include="\'ng-table/filters/\' + filter + \'.html\'"></div> </div> </div> </th> </tr>'),$templateCache.put("ng-table/pager.html",'<div class="ng-cloak ng-table-pager"> <div ng-if="params.settings().counts.length" class="ng-table-counts btn-group pull-right"> <button ng-repeat="count in params.settings().counts" type="button" ng-class="{\'active\':params.count()==count}" ng-click="params.count(count)" class="btn btn-default"> <span ng-bind="count"></span> </button> </div> <ul class="pagination ng-table-pagination"> <li ng-class="{\'disabled\': !page.active}" ng-repeat="page in pages" ng-switch="page.type"> <a ng-switch-when="prev" ng-click="params.page(page.number)" href="">&laquo;</a> <a ng-switch-when="first" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="page" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="more" ng-click="params.page(page.number)" href="">&#8230;</a> <a ng-switch-when="last" ng-click="params.page(page.number)" href=""><span ng-bind="page.number"></span></a> <a ng-switch-when="next" ng-click="params.page(page.number)" href="">&raquo;</a> </li> </ul> </div> ')}]),app});